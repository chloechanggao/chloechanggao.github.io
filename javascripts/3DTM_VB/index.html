<!DOCTYPE html>
<html lang="en">

<head>
	<title>three.js webgl - modifier - tessellation</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<style>
		body {
			color: #ffffff;
			font-family: Monospace;
			font-size: 13px;
			text-align: center;
			font-weight: bold;
			background-color: #000000;
			margin: 0px;
			overflow: hidden;
		}
	</style>
</head>

<body>
	<!-- <div id="info"><a href="http://threejs.org" target="_blank">three.js</a> - modifier tessellation</div> -->
	<div id="container"></div>

	<script src="shared/three.js"></script>
	<script src="shared/TrackballControls.js"></script>
	<script src="shared/ExplodeModifier.js"></script>
	<script src="shared/TessellateModifier.js"></script>
	<script src="shared/Detector.js"></script>
	<script src="shared/stats.min.js"></script>

	<script src="3DTM_b.js"></script>

	<script type="x-shader/x-vertex" id="vertexshader">
		uniform float amplitude;
		uniform vec3 stimu;

		attribute vec3 customColor;
		attribute vec3 displacement;

		//varying vec3 vNormal;
		varying vec3 vColor;
		varying vec3 vPos;


		void main() {
			//vNormal = normal;
			vColor = customColor;
			vec3 newPosition = position + normal * amplitude * displacement * distance(position, stimu) * 0.015;
			vPos = newPosition;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
		}
	</script>

	<script type="x-shader/x-fragment" id="fragmentshader">
	  uniform vec3 lightpos;
		uniform vec3 stimu;
		//uniform vec3 bottomColor;

		//varying vec3 vNormal;
		varying vec3 vColor;
		varying vec3 vPos;

		void main() {
			const float ambient = 0.75;
			//vec3 light = vec3( 1.0 );
			//light = normalize( light );

			float directional = 15.0 / distance(vPos, stimu);
			//max( dot( vNormal, light ), 0.25 );
		  gl_FragColor = vec4( (directional+ambient)*vColor.x, (directional+ambient)*vColor.y,  (directional+ambient)*vColor.z,  0.9);


		 }

	</script>


</body>

</html>
